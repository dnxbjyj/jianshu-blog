> 声明：本系列文章参考了《MATLAB 8.X实战指南（R2014a中文版）》（清华大学出版社，赵小川等编著），仅用于个人学习总结和交流，禁止作为商业用途转载或使用。

Matlab可以看成是一个功能强大的计算器，那么既然是计算器，进行基本的数学运算绝对是必不可少的。本文主要讲解如何用Matlab做初等数学运算，所谓“初等数学运算”，可以理解成是小学中学数学学习的那些运算，包括如下这些：四则运算、指数、对数、幂运算、三角函数、多项式运算等。

# 加减乘除四则运算

四则运算就非常简单了，下面用一个简单示例来看一下：

```
?result = (1+2) * 3 / 9

result =

     1

?a = 1 + 2i;  % a是一个复数
?b = 3 - 4j;  % b也是一个复数
?a + b

ans =

   4.0000 - 2.0000i

?sin(pi/2)  % pi表示圆周率

ans =

     1
```

# 幂、指数、对数运算

示例如下：

```
?a = 2 ^ 3

a =

     8

?b = 25 ^ (1/2)

b =

     5

?r = exp(1)  % exp(x)表示求自然对数的底e的x次方

r =

    2.7183

?log(exp(1))  % log(x)表示求x的以e为底的对数

ans =

     1

?log10(100)  % log10(x)表示求x的以10为底的对数

ans =

     2

?array = [1,2,3];
?array ^ 2  % 求数组的指数，如果用普通的指数运算符"^"会报错
??? Error using ==> ^
Matrix must be square.

?array .^ 2  % 对数组或矩阵求指数，要使用".^"运算符，运算结果是对数组或矩阵的每一个元素都求指数

ans =

     1     4     9
```

其中要注意的是：

* 对数组或矩阵求指数，要使用`.^`运算符，运算结果是对数组或矩阵的每一个元素都求指数。注：乘法、除法也是类似的道理，数组或矩阵的乘法和除法要使用：`.*`和`./`。
* log(x)其实相当于ln(x)，而log10(x)才相当于求x的以10为底的对数。

# 三角函数运算（包括反三角函数）

举例如下：

```
?sin(pi/3)

ans =

    0.8660

?cos(pi)

ans =

    -1

?asin(pi)  % 求pi的反正弦函数值

ans =

   1.5708 + 1.8115i
```

# 多项式运算
Matlab处理多项式也是非常强大，那么什么是多项式呢？其实我们初中的时候都学过，多项式合并同类项、多项式因式分解等等，这些名词是不是都很熟悉？类似于下面这些的由多个式子组成的式子就是多项式：
* `x`
* `x + 1`
* `1.22x^2 + x -8`
* `3x^3 + 5x^2 - 1`
* `x^8 + 12x + 1`

一个多项式的次数就是这个多项式中x的最高次数，比如`x + 1`就是一个一次多项式，而`3x^3 + 5x^2 - 1`就是一个三次多项式。

### 多项式的表示
要处理多项式，那么首先需要有一种方法来表示多项式，在Matlab中是用行向量来表示一个多项式的，行向量的每个元素是原多项式中根据x的次数降序排列后的x的系数。

比如`p(x) = 3x^3 + 5x^2 - 1`这个多项式就可以表示为下面这样一个行向量：
`[3,5,0,-1]`

这里第三项为`0`，是因为多项式`p(x)`的一次项为0。

可以看出，一个n次多项式表示成行向量后，是一个长度为`n+1`的行向量。

### 多项式求值
知道一个多项式的表达式后，就可以把它表示成Matlab行向量，那么如果还知道x的值，怎么求这个多项式的值呢？答案是使用`polyval`函数，用法如下：
```m
polyval(p,s)
% 其中p为多项式的系数行向量，s为给定的x的值（可以是数值也可以是矩阵）
```

下面举个例子来求多项式`p(x) = x^3 + 2x^2 + 1`在`x = 2`、`x = [3,4,5]`和`x = [1,2;3,4]`时候的值：
```m
?p = [1,2,0,1];
?x1 = 2;
?x2 = [3,4,5];
?disp(polyval(p,x1));
    17

?disp(polyval(p,x2));
    46    97   176

?x3 = [1,2;3,4];
?disp(polyval(p,x3));
     4    17
    46    97
```
可以看出x的值如果是一个矩阵的话，将会逐个算出x矩阵中每个元素代入多项式后求出的值。

### 多项式加减法
不同的多项式之间可以进行加减运算，这也就是我们在初中时候学过的多项式合并同类项。要注意的是，在Matlab中进行加减运算的多项式的行向量必须是长度相同的，如果不同，长度较短的行向量的高次项系数要用0补齐。

举个栗子，来算一下`x^3 + 2x - 1`和`x + 1`两个多项式的和：
```m
?p1 = [1,0,2,-1];
?p2 = [1,1];  % p2的长度比p1小，所以高次项系数要补0
?p2 = [0,0,1,1];
?disp(p1 + p2)
     1     0     3     0
```

所以`x^3 + 2x - 1`和`x + 1`两个多项式的和为：`x3 + 3x`

### 多项式乘除法
不同的多项式之间除了可以进行加减法运算，还可以进行乘除法运算。

* 多项式乘法用`conv`函数：
```m
p = conv(p1,p2)
% 其中p1、p2分别为两个多项式，p是p1和p2的乘积多项式。
```
举个栗子：
```m
?p1 = [1,0];  % 表示多项式：x
?p2 = [1,1];  % 表示多项式：x + 1
?p3 = [1,20]; % 表示多项式：x + 20
?a1 = conv(p1,p2);  % 求多项式：x(x+1)
?disp(a1)
     1     1     0

?a2 = conv(a1,p3);  % 求多项式：x(x+1)(x+20)
?disp(a2)
     1    21    20     0
```

* 多项式除法用`deconv`函数：
```m
[q,r] = deconv(p1,p2)
% 因为两个多项式相除的结果不一定能除尽，所以可能会有余子式，这里的q就是多项式p1和p2的商的多项式，而r就是除不尽时候的余子式。
```

举个栗子：
```m
?p1 = [1,0,-3];   % 表示多项式：x^2 - 3，即：(x+1)(x-1) - 2
?p2 = [1,1];  % 表示多项式：x + 1

?[q,r] = deconv(p1,p2);
?disp(q)  % 结果为：x - 1
     1    -1

?disp(r)  % 余子式为：-2
     0     0    -2
```

### 多项式求根
一个多项式的根就是该多项式的函数图像和x轴的交点的x的值，也就是当多项式的值为0时x的取值，可以想象的是，一个多次多项式的根可能不止一个，也可能有复数根，比如：`x^2 + 1`的根就是两个复数：`i` 和 `-i`

求多项式的根用`roots`函数来实现：
```m
r = roots(p)
% r是一个列向量，代表多项式p的根集合，根有可能是复数
```

那么反过来，如果已知一个多项式的根向量，能不能求出这个多项式呢？答案是可以的，用`poly`函数即可：
```m
p = poly(r)
% 其中r为多项式的根向量（列向量），p为多项式的系数行向量
```

下面举个栗子来说明以上两个函数的用法：
```m
?p = [1,0,2,-1];  % 表示多项式：x^3 + 2x - 1
?r = roots(p)  % 求根

r =

  -0.2267 + 1.4677i
  -0.2267 - 1.4677i
   0.4534          

?pp = poly(r)  % 根据根列向量求多项式的系数行向量

pp =

    1.0000    0.0000    2.0000   -1.0000
```

### 多项式求导
多项式求导有三个函数可以使用，功能十分之强大：
```m
p = polyder(p1)  % 求多项式p1的导函数
p = polyder(p1,p2)  % 求多项式p1和p2的乘积多项式的导函数
[p,q] = polyder(p1,p2)  % 求多项式p1和p2的商的导函数，p和q分别为导函数的分子和分母
```

举个栗子来说明：
对分式：
![](http://upload-images.jianshu.io/upload_images/8819542-8c26a8a6137a1bb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

求导：
```m
?p1 = [1,-1];  % 表示多项式：x - 1
?p2 = [1,-1,3];  % 表示多项式：x^2 - x + 3
?[p,q] = polyder(p1,p2);  % 对p1/p2求导
?p

p =

    -1     2     2

?q

q =

     1    -2     7    -6     9
```
求导结果表明，原分式函数的导函数为：
![](http://upload-images.jianshu.io/upload_images/8819542-52090ecedd5e8ef3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 求多项式的部分分式展开
在实际应用中，比如傅里叶变换、拉普拉斯变换、Z变换都会出现对多项式分式进行展开的场景，那么Matlab也是支持对多项式进行展开运算的，使用`residue`函数，语法如下：
```m
[r,p,k] = residue(b,a)
% 其中b和a分别为原多项式的分子、分母多项式系数行向量，r是一个行向量，表示部分分式展开的常数项；p为行向量，表示分母的极点；k为余数项系数行向量。
```

举个栗子：
对如下分式`f(x)`进行部分分式展开：
![](http://upload-images.jianshu.io/upload_images/8819542-26118f54a3760275.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
```m
?p1 = [100,200];  % 分子多项式
?p2 = [1,21,20,0];  % 分母多项式
?[r,p,k] = residue(p1,p2)

r =

   -4.7368
   -5.2632
   10.0000


p =

   -20
    -1
     0


k =

     []
```
结果表明，部分分式展开式为：
![](http://upload-images.jianshu.io/upload_images/8819542-0a7bd6670a9698b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


